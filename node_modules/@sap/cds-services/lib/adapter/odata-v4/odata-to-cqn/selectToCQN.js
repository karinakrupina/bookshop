/**
 * Add odata select to a CQN object.
 *
 * @param {string} select - odata select string
 * @param {array} keys - array of primary keys
 * @private
 */
const selectToCQN = (select, keys) => {
  const elements = new Set()
  const columns = select.split(',')
  if (columns.indexOf('*') !== -1) {
    return []
  }

  for (const col of columns) {
    elements.add(col)
  }

  for (const key of keys) {
    // add key, as odata-v4 always expects the key here.
    if (key && !elements.has(key)) {
      elements.add(key)
    }
  }

  return Array.from(elements)
}

module.exports = selectToCQN
